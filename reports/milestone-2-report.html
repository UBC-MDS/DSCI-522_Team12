<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.179">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ty Andrews">
<meta name="author" content="Dhruvi Nishar">
<meta name="author" content="Luke Yang">

<title>Analysis of Customer Complaints on US Financial Products</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="milestone-2-report_files/libs/clipboard/clipboard.min.js"></script>
<script src="milestone-2-report_files/libs/quarto-html/quarto.js"></script>
<script src="milestone-2-report_files/libs/quarto-html/popper.min.js"></script>
<script src="milestone-2-report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="milestone-2-report_files/libs/quarto-html/anchor.min.js"></script>
<link href="milestone-2-report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="milestone-2-report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="milestone-2-report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="milestone-2-report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="milestone-2-report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="toc-section-number">0.1</span>  Summary</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="toc-section-number">0.2</span>  Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="toc-section-number">0.3</span>  Methods</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="toc-section-number">0.3.1</span>  Data</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="toc-section-number">0.3.2</span>  Analysis</a></li>
  </ul></li>
  <li><a href="#results-discussion" id="toc-results-discussion" class="nav-link" data-scroll-target="#results-discussion"><span class="toc-section-number">0.4</span>  Results &amp; Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">0.5</span>  Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">1</span>  References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of Customer Complaints on US Financial Products</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Ty Andrews </p>
             <p>Dhruvi Nishar </p>
             <p>Luke Yang </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="summary" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">0.1</span> Summary</h2>
<p>Here we used multiple classification algorithms to predict whether a financial product consumer will dispute a complaint made to the Consumer Financial Protection Bureaus’ (CFPB) Consumer Complaints Database<span class="citation" data-cites="COMPL_DB">(<a href="#ref-COMPL_DB" role="doc-biblioref"><em>Consumer Complaints Database</em> 2022</a>)</span>.</p>
</section>
<section id="introduction" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="introduction"><span class="header-section-number">0.2</span> Introduction</h2>
<p>As of 2022, the CFPB receives over 60,000 consumer complaints a month related to companies financial products. Between December 2011 and November 2022 over 140,000 complaints were disputed by consumers costing both the companies and CFPB time and money.</p>
<p>Complaints can be responded to by the company in multiple ways but each consumer has the opportunity to dispute the provided response. These disputes are likely costly to both the CFPB and the companies for which they are raised so being able to anticipate whether a complaint will be disputed has the potential to save both time and money for companies and the CFPB alike. Especially, as we observed that the number of complaints spikes near 2022 (Figure 1), it is essential to understand the tactics of handling these complaints.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure 1. Complaints Over Timeline</figcaption><p></p>
<p><img src="assets/complaints_over_time_line.png" class="img-fluid figure-img" alt="Figure 1. Complaints Over Timeline"></p>
</figure>
</div>
</section>
<section id="methods" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="methods"><span class="header-section-number">0.3</span> Methods</h2>
<section id="data" class="level3" data-number="0.3.1">
<h3 data-number="0.3.1" class="anchored" data-anchor-id="data"><span class="header-section-number">0.3.1</span> Data</h3>
<p>We used pandas<span class="citation" data-cites="pandas">(<a href="#ref-pandas" role="doc-biblioref">McKinney 2010</a>)</span>, scikit-learn<span class="citation" data-cites="scikit-learn">(<a href="#ref-scikit-learn" role="doc-biblioref">Pedregosa et al. 2011</a>)</span>, and TidyVerse <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span> to collect, analyze, and summarize our data. The CFPB database contains ~3 million complaints starting from December 2011 all the way up to November 2022 when this report was written. Approximately 4.8% of all complaints are disputed, with the ~75.1% of complaints having an unknown dispute status. Figure 2 below shows the balance of dispute status.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure 2. Class Imbalance in the Target Column</figcaption><p></p>
<p><img src="assets/disputed_bar.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Each field has varying amounts of missing values as can be seen in Table 1 below. Fields such as tag where there are numerous entries missing values were removed from the analysis. Individual complaints with missing information were removed from the data-set for analysis since the data set is large enough to still have a significant number of training examples for the analysis (~20,000).</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Table 1. Unique and missing value counts by data feature.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">columns</th>
<th style="text-align: right;">valid_count</th>
<th style="text-align: right;">unique_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Unnamed: 0</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">3084450</td>
</tr>
<tr class="even">
<td style="text-align: left;">date_received</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">4003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">product</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">sub_product</td>
<td style="text-align: right;">2849156</td>
<td style="text-align: right;">76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">issue</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">165</td>
</tr>
<tr class="even">
<td style="text-align: left;">sub_issue</td>
<td style="text-align: right;">2401899</td>
<td style="text-align: right;">221</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumer_complaint_narrative</td>
<td style="text-align: right;">1107253</td>
<td style="text-align: right;">967541</td>
</tr>
<tr class="even">
<td style="text-align: left;">company_public_response</td>
<td style="text-align: right;">1339720</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">company</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">6565</td>
</tr>
<tr class="even">
<td style="text-align: left;">state</td>
<td style="text-align: right;">3044459</td>
<td style="text-align: right;">63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zip_code</td>
<td style="text-align: right;">3043948</td>
<td style="text-align: right;">34429</td>
</tr>
<tr class="even">
<td style="text-align: left;">tags</td>
<td style="text-align: right;">350065</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">consumer_consent_provided</td>
<td style="text-align: right;">2264772</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">submitted_via</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">date_sent_to_company</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">3952</td>
</tr>
<tr class="even">
<td style="text-align: left;">company_response_to_consumer</td>
<td style="text-align: right;">3084446</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">timely_response</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">consumer_disputed</td>
<td style="text-align: right;">768443</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">complaint_id</td>
<td style="text-align: right;">3084450</td>
<td style="text-align: right;">3084450</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analysis" class="level3" data-number="0.3.2">
<h3 data-number="0.3.2" class="anchored" data-anchor-id="analysis"><span class="header-section-number">0.3.2</span> Analysis</h3>
<p>A predictive approach using multiple classification models was used to attempt to predict whether a consumer would dispute a complaint or not.</p>
<p>Feature pre-processing approach and rationale is as follows:</p>
<table class="table">
<caption>These features were passed into a column transformer, which was then integrated with five different estimator for prediction.</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 26%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Features</th>
<th>Preprocessing Step</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>consumer_complaint_narrative</td>
<td><p>CountVectorizer</p>
<p>max_features = 1000</p></td>
<td>High Amount of Unique Textual Data</td>
</tr>
<tr class="even">
<td><p>product</p>
<p>sub_product</p>
<p>issue</p>
<p>company_public_response</p>
<p>company</p>
<p>company_response_to_consumer</p></td>
<td><p>OneHotEncoder (Binary)</p>
<p>OneHotEncoder</p>
<p>OneHotEncoder</p>
<p>OneHotEncoder</p>
<p>OneHotEncoder</p>
<p>OneHotEncoder</p></td>
<td><p>Two Products Included</p>
<p>Categorical Values</p>
<p>Categorical Values</p>
<p>Categorical Values</p>
<p>Categorical Values</p>
<p>Categorical Values</p></td>
</tr>
<tr class="odd">
<td>consumer_consent_provided</td>
<td>dropped</td>
<td>Single Category</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="results-discussion" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="results-discussion"><span class="header-section-number">0.4</span> Results &amp; Discussion</h2>
<p>We applied the <code>DummyClassifier</code>, <code>LogisticRegression</code>, <code>Naive Bayes</code>, <code>SVC</code>, and <code>RandomForestClassifier</code> to predict the target whether the customer disputed. The models were applied using default parameters and a five-fold cross-validation were applied using the training split. We examined and recorded the accuracy, precision, recall, and f1 scores to be the metrics evaluating the models. The results of the cross validation is presented below:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Table 2. Model Performance and Score.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">dummy</th>
<th style="text-align: right;">logreg</th>
<th style="text-align: right;">bayes</th>
<th style="text-align: right;">svc</th>
<th style="text-align: right;">random.forest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fit_time</td>
<td style="text-align: right;">0.978</td>
<td style="text-align: right;">5.475</td>
<td style="text-align: right;">1.674</td>
<td style="text-align: right;">123.556</td>
<td style="text-align: right;">22.726</td>
</tr>
<tr class="even">
<td style="text-align: left;">score_time</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.431</td>
<td style="text-align: right;">0.369</td>
<td style="text-align: right;">24.588</td>
<td style="text-align: right;">0.592</td>
</tr>
<tr class="odd">
<td style="text-align: left;">test_accuracy</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">0.702</td>
<td style="text-align: right;">0.679</td>
<td style="text-align: right;">0.784</td>
</tr>
<tr class="even">
<td style="text-align: left;">test_recall</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.455</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">0.445</td>
<td style="text-align: right;">0.056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">test_precision</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.631</td>
</tr>
<tr class="even">
<td style="text-align: left;">test_f1</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.368</td>
<td style="text-align: right;">0.337</td>
<td style="text-align: right;">0.380</td>
<td style="text-align: right;">0.102</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Figure 3 below illustrates a visual representation of the performance of the models. We observe a high accuracy of the <code>DummyClassifier</code>. Given the imbalance of the class, the accuracy would not be an important metric in this problem. Instead, from the company’s perspective, we focus more on improving the precision, the recall, and the f1 score. Noticeably the company likely wants to spot the people who are going to dispute, thus, the recall score here is more important compared to precision.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p></p><figcaption class="figure-caption">Figure 3: Performance of Different Models on Different Metrics</figcaption><p></p>
<p><img src="assets/model_performance.png" class="img-fluid figure-img" alt="Performance of Different Models on Different Metrics"></p>
</figure>
</div>
<p>The results above motivates us to choose <code>LogisticRegression</code> as the final estimator. It has overall a great f1 score and among the recall is among highest scores. Though we sacrifices some accuracy, the precision, recall, and f1 scores are significantly improved. We also see that <code>SVC</code> gives slightly higher scores than <code>LogisticRegression</code>; however, in Table 2 we see that it takes substantially more time to train and cross validate. in addition, due to the complexity of the model we also lose a degree of model incontestability. Overall, we choose <code>LogisticRegression</code> over <code>SVC</code> due to its scalability and interpretability.</p>
</section>
<section id="conclusion" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">0.5</span> Conclusion</h2>
<p>The analysis in this reports focuses on using a machine learning approach to predict whether the consumer is going to dispute after the company’s response. We processed the features such as the product, consumer’s complaints, and company’s responses. We trained five different models that optimized the f1 score and chose <code>LogisticRegression</code> as a suitable estimator for analysis of this problem.</p>
</section>
<section id="references" class="level1 unnumbered" data-number="1">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">1 References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-COMPL_DB" class="csl-entry" role="doc-biblioentry">
<em>Consumer Complaints Database</em>. 2022. Consumer Financial Protection Bureau. <a href="https://www.consumerfinance.gov/data-research/consumer-complaints/#download-the-data">https://www.consumerfinance.gov/data-research/consumer-complaints/#download-the-data</a>.
</div>
<div id="ref-pandas" class="csl-entry" role="doc-biblioentry">
McKinney, Wes. 2010. <span>“<span>D</span>ata <span>S</span>tructures for <span>S</span>tatistical <span>C</span>omputing in <span>P</span>ython.”</span> In <em><span>P</span>roceedings of the 9th <span>P</span>ython in <span>S</span>cience <span>C</span>onference</em>, edited by Stéfan van der Walt and Jarrod Millman, 56–61. <a href="https://doi.org/ 10.25080/Majora-92bf1922-00a ">https://doi.org/ 10.25080/Majora-92bf1922-00a </a>.
</div>
<div id="ref-scikit-learn" class="csl-entry" role="doc-biblioentry">
Pedregosa, F., G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel, et al. 2011. <span>“Scikit-Learn: Machine Learning in <span>P</span>ython.”</span> <em>Journal of Machine Learning Research</em> 12: 2825–30.
</div>
<div id="ref-tidyverse" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>